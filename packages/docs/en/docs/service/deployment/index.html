<!doctype html>
<html>
  <head>
	<meta charset="utf-8">
	<title>Deployment</title>
    <meta name="generator" content="Qgoda vv0.10.1 (https://www.qgoda.net/)" />
</head>
  <body>
	<h1>Deployment</h1>
	[% '' %]
[% '' %]
[% '' %]
[% '' %]
[% '' %]
[% '' %]

[% USE q = Qgoda %]
[% USE Highlight(config.private.copyCode) %]
[% USE CodeGroup %]


The E-Invoice-EU service can be used in one of several ways:

* Run as a (docker) container.
* Build and run it in production mode.
* Run it locally in development mode.

<qgoda-toc />

## Docker Container

By far, the easiest way to run the E-Invoice-EU service is to run the
containerized version.


[% FILTER $CodeGroup %]
[docker]
[% FILTER $Highlight "language-sh" %]docker pull gflohr/e-invoice-eu:latest
docker run --rm -p 3000:3000 --name e-invoice-eu gflohr/e-invoice-eu:latest
[% END %] 
[nerdctl]
[% FILTER $Highlight "language-sh" %]nerdctl pull gflohr/e-invoice-eu:latest
nerdctl run --rm -p 3000:3000 --name e-invoice-eu gflohr/e-invoice-eu:latest
[% END %] 
[% END %]


## Download

All other possibilities require a local copy of the sources.

You can download the latest stable version from the [download
page](https://github.com/gflohr/e-invoice-eu/releases) and then unzip the
ZIP archive or untar the tarball.

If you have `git`, you can also clone the repository:


[% FILTER $Highlight "language-sh" %]
# HTTPS
git clone https://github.com/gflohr/e-invoice-eu.git

# SSH
git clone git@github.com:gflohr/e-invoice-eu.git
[% END %] 


The version you will get by cloning the repository is potentially a little bit
more up-to-date.

## Deploy in Production Mode

You can also build the server and then run it anywhere you like. After
cloning the repository and changing into its root directory, execute the
following commands:


[% FILTER $CodeGroup %]
[npm]
[% FILTER $Highlight "language-sh" %]
npm install
npm run build
[% END %]

[yarn]
[% FILTER $Highlight "language-sh" %]
yarn install
yarn run build
[% END %]

[pnpm]
[% FILTER $Highlight "language-sh" %]
pnpm install
pnpm run build
[% END %] 

[bun]
[% FILTER $Highlight "language-sh" %]
bun install
bun run build
[% END %] 

[% END %]


### Run with Node.js

You can then run the application with Node.js like this:


[% FILTER $CodeGroup %]
[npm]
[% FILTER $Highlight "language-sh" %]
NODE_ENV=production npm run start:prod
[% END %]

[yarn]
[% FILTER $Highlight "language-sh" %]
NODE_ENV=production yarn run start:prod
[% END %]

[pnpm]
[% FILTER $Highlight "language-sh" %]
NODE_ENV=production pnpm run start:prod
[% END %]

[bun]
[% FILTER $Highlight "language-sh" %]
NODE_ENV=production pnpm run start:prod
[% END %]

[% END %]


See the [NestJS documentation for deployment](https://docs.nestjs.com/deployment)
for more information.

### Run with Bun or Deno

You can also run the application with [`bun`](https://bun.sh/) or
[`deno`](https://deno.com/). But you then have to specify the
complete path to the main JavaScript file:


[% FILTER $CodeGroup %]
[bun]
[% FILTER $Highlight "language-sh" %]
NODE_ENV=production bun apps/server/dist/main.js
[% END %]

[deno]
[% FILTER $Highlight "language-sh" %]
NODE_ENV=production deno --allow-env --allow-read --allow-net apps/server/dist/main.js
[% END %]

[node]
[% FILTER $Highlight "language-sh" %]
NODE_ENV=production node apps/server/dist/main.js
[% END %]

[% END %]


## Run in Development Mode

You can also run the application without building it first.


[% FILTER $CodeGroup %]
[npm]
[% FILTER $Highlight "language-sh" %]
cd apps/server
npm install
npm run start:dev
[% END %]

[yarn]
[% FILTER $Highlight "language-sh" %]
cd apps/server
yarn install
yarn run start:dev
[% END %]

[pnpm]
[% FILTER $Highlight "language-sh" %]
cd apps/server
pnpm install
pnpm run start:dev
[% END %] 

[bun]
[% FILTER $Highlight "language-sh" %]
cd apps/server
bun install
bun run start:dev
[% END %] 

[% END %]


This will automatically re-compile the source code and re-start the server,
whenever you make changes to the code.

## Environment Variables

The service is configured with environment variables.

You can either pass these environment variables on the commandline or place
a file called `.env` in the directory, where you start the service.  This
file has lines of the form `VARIABLE=VALUE`, see the [dotenv
docs](https://www.npmjs.com/package/dotenv#%EF%B8%8F-usage) for more
information.

If you are running the docker container, you must either bind mount an
`.env` file into the container or pass the environment variable on the
commandline with option `-e`:


[% FILTER $CodeGroup %]
[docker]
[% FILTER $Highlight "language-sh" %]
docker run --rm -p 3300:3300 --name e-invoice-eu -e PORT=3300 gflohr/e-invoice-eu:latest
[% END %] 
[nerdctl]
[% FILTER $Highlight "language-sh" %]
nerdctl run --rm -p 3300:3300 --name e-invoice-eu -e PORT=3300 gflohr/e-invoice-eu:latest
[% END %] 
[% END %]


This would start the service on port 3300 instead of port 3000 (although it
would be easier to simply map port 3300 to the host port 3000).

The following environment variables are supported:


### `NODE_ENV`


To quote the NestJS documentation:

> While there's technically no difference between development and production in Node.js and NestJS, it's a good practice to set the NODE_ENV environment variable to production when running your application in a production environment, as some libraries in the ecosystem may behave differently based on this variable (e.g., enabling or disabling debugging output, etc.).

In brief: Set the environment variable to "production", when running the
service in production mode.


### `PORT`


Set this to a valid port number if you are not happy with the default port of
3000.

Note: This has currently no effect, when running the service in a container,
see https://github.com/gflohr/e-invoice-eu/issues/76.


### `LIBRE_OFFICE`


Path to [LibreOffice](https://www.libreoffice.org/). E-Invoice-EU uses
LibreOffice in headless mode to generate PDFs from spreadsheet files. It
depends on your usage whether you need that or not.

On macOS, LibreOffice is usually installed as:


```
/Applications/LibreOffice.app/Contents/MacOS/soffice
```


On Windows, the path is:


```
C:\Program Files\LibreOffice\program\soffice.exe
```


If the location of the LibreOffice executable is not configured, it is searched
in `$PATH`.


### `LIBREOFFICE`


An alias for the environment variable [`LIBRE_OFFICE`](#libre_office-code).

	<p>This view has been automatically created.  Please edit  '/data/_views/default.html' to your needs!</p>
  </body>
</html>